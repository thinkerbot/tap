<dl class="configs">
<% configs.each_pair do |key, config| %>
<%  next if config[:type] == :hidden %>
<%  config_name = "#{name}[#{key.inspect}]" %>
<%  value = values[key] %>
<%  if config.is_nest? %>
  <dt class="name"><%= key %></dt>
  <dd class="nested-configs">
<%    configurations = config.default(false).delegates %>
<%=   module_render("_configs.erb", obj, :locals => {
        :name => config_name,
        :configs => configurations, 
        :values => value || default_config(configurations)
      }) %>
  </dd>
<%  else %>
  <dt><%= key %></dt>
  <dd class="config">
<%  if config_template = module_path("_#{config[:type]}.erb", obj)  %>
<%=   render(
        :file => config_template, 
        :locals => {
          :obj => obj,
          :name => config_name,
          :config => config,
          :value => value}) %>
<%  else%>
  <input name="<%= config_name %>" type="text" value="<%= format_yaml(value) %>" />
<%  end %>
  </dd>
<%  end %>
<% end %>
</dl>